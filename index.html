<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Signature Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=Lato:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Fira Sans', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .main-content {
            flex-grow: 1;
        }
        /* Simple transition for a smoother feel */
        .transition-all {
            transition: all 0.3s ease-in-out;
        }
        .brand-bg { background-color: #cb2039; }
        .brand-bg:hover { opacity: 0.9; }
        .brand-text { color: #cb2039; }
        .brand-border { border-color: #cb2039; }
        .focus-brand-ring:focus {
            --tw-ring-color: #cb2039;
        }
        /* Style for the color picker */
        input[type="color"] {
            -webkit-appearance: none;
            border: none;
            width: 100%;
            height: 40px;
            border-radius: 0.375rem;
            cursor: pointer;
        }
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        input[type="color"]::-webkit-color-swatch {
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
        }
        /* Custom file input button */
        .file-input-button {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
        }
        .file-input-button:hover {
            background-color: #e5e7eb;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="main-content container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <div class="flex justify-center mb-4">
                <svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 933.41 933.41" class="h-24 w-24">
                    <defs><style>.cls-1{fill:#cb2039;}.cls-1,.cls-2{stroke-width:0px;}.cls-2{fill:#fff;}</style></defs>
                    <g id="Layer_1-2">
                        <circle class="cls-2" cx="466.7" cy="466.7" r="466.7"/>
                        <path class="cls-1" d="M466.7,40.45c-107.68,0-206.03,39.93-281.06,105.79v245.11c0,10.75,8.71,19.46,19.46,19.46h141.11c14.56.14,18.03,10.07,19.26,21.98,1.29,12.59,2.25,23.88,4.15,40.14,2.18,18.51-7.76,23.75-23,23.75H120.53c-10.75,0-19.46-8.71-19.46-19.46v-229.72c-38.49,64.05-60.62,139.05-60.62,219.21,0,235.41,190.84,426.25,426.25,426.25,1.52,0,3.03-.01,4.55-.03-15.1-121.41-43.29-348.8-57.67-464.56-1.16-9.39,4.22-18.17,13.68-18.17h43.55c6.6,0,12.32,4.56,13.81,10.95,0,0,26.67,253.65,35.72,338.97,1.56,15.04,29.8,13.4,36.4-.2,43-88.66,119.48-250.59,161.25-338.57,2.86-6.06,9.46-10.68,16.13-10.61,20.14.27,47.49,0,61.85,0,13.27,0,17.96,9.05,13.68,17.49-60.51,118.86-167.77,325.41-232.37,450.24,181.81-48.7,315.68-214.59,315.68-411.76,0-235.41-190.84-426.25-426.25-426.25Z"/>
                    </g>
                </svg>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Email Signature Generator</h1>
            <p class="text-gray-600 mt-2">Create your professional email signature in seconds.</p>
        </header>

        <div class="flex flex-col lg:flex-row gap-8">

            <!-- Input Form -->
            <div class="lg:w-1/3 bg-white p-6 rounded-lg shadow-md">
                 <div class="border-b pb-4 mb-4">
                    <h2 class="text-2xl font-semibold">Manage Signatures</h2>
                    <div class="mt-4 space-y-2">
                        <select id="savedSignatures" class="block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus-brand-ring focus:border-gray-300">
                            <option>No signatures saved</option>
                        </select>
                        <div class="flex gap-2">
                            <button id="loadSignatureBtn" class="w-full bg-gray-200 py-2 px-4 rounded-md hover:bg-gray-300 transition-all">Load</button>
                            <button id="deleteSignatureBtn" class="w-full bg-red-100 text-red-700 py-2 px-4 rounded-md hover:bg-red-200 transition-all">Delete</button>
                        </div>
                    </div>
                </div>

                <h2 class="text-2xl font-semibold mb-6 border-b pb-3">Your Details</h2>
                <div class="space-y-4">
                     <div>
                        <label for="accentColor" class="block text-sm font-medium text-gray-700">Accent Color</label>
                        <input type="color" id="accentColor" value="#cb2039" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm">
                    </div>
                    <div>
                        <label for="fontStyle" class="block text-sm font-medium text-gray-700">Font Style</label>
                        <select id="fontStyle" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus-brand-ring focus:border-gray-300">
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="'Times New Roman', Times, serif">Times New Roman</option>
                            <option value="Verdana, Geneva, sans-serif">Verdana</option>
                            <option value="'Courier New', Courier, monospace">Courier New</option>
                            <option value="'Inter', sans-serif" selected>Inter</option>
                            <option value="'Roboto', sans-serif">Roboto</option>
                            <option value="'Lato', sans-serif">Lato</option>
                        </select>
                    </div>
                    <div>
                        <label for="fullName" class="block text-sm font-medium text-gray-700">Full Name</label>
                        <input type="text" id="fullName" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="John Doe">
                    </div>
                    <div>
                        <label for="jobTitle" class="block text-sm font-medium text-gray-700">Job Title</label>
                        <input type="text" id="jobTitle" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="Software Engineer">
                    </div>
                    <div>
                        <label for="company" class="block text-sm font-medium text-gray-700">Company</label>
                        <input type="text" id="company" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="Tech Solutions Inc.">
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                        <input type="tel" id="phone" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="+1 (123) 456-7890">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                        <input type="email" id="email" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="john.doe@example.com">
                    </div>
                    <div>
                        <label for="website" class="block text-sm font-medium text-gray-700">Website URL</label>
                        <input type="url" id="website" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="https://example.com">
                    </div>
                     <div>
                        <label for="imageUpload" class="block text-sm font-medium text-gray-700">Upload Picture/Logo</label>
                        <input type="file" id="imageUpload" accept="image/*" class="hidden">
                        <label for="imageUpload" class="mt-1 cursor-pointer w-full text-center px-3 py-2 rounded-md shadow-sm file-input-button block">Choose File</label>
                        <p id="uploadStatus" class="text-xs text-gray-500 mt-1"></p>
                        <input type="hidden" id="imageUrl">
                    </div>
                     <div>
                        <label for="imageShape" class="block text-sm font-medium text-gray-700">Image Shape</label>
                        <select id="imageShape" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus-brand-ring focus:border-gray-300">
                            <option value="circle" selected>Circle</option>
                            <option value="square">Square</option>
                            <option value="wide">Wide (16:9)</option>
                            <option value="standard">Standard (4:3)</option>
                        </select>
                    </div>
                    <!-- Social Media Inputs -->
                    <div class="border-t pt-4">
                        <h3 class="text-lg font-semibold mb-2">Social Media</h3>
                        <div>
                            <label for="linkedin" class="block text-sm font-medium text-gray-700">LinkedIn</label>
                            <input type="url" id="linkedin" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="https://linkedin.com/in/yourprofile">
                        </div>
                         <div class="mt-4">
                            <label for="twitter" class="block text-sm font-medium text-gray-700">Twitter / X</label>
                            <input type="url" id="twitter" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="https://x.com/yourprofile">
                        </div>
                         <div class="mt-4">
                            <label for="instagram" class="block text-sm font-medium text-gray-700">Instagram</label>
                            <input type="url" id="instagram" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="https://instagram.com/yourprofile">
                        </div>
                         <div class="mt-4">
                            <label for="facebook" class="block text-sm font-medium text-gray-700">Facebook</label>
                            <input type="url" id="facebook" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="https://facebook.com/yourprofile">
                        </div>
                    </div>
                    <div class="border-t pt-4">
                        <label for="slogan" class="block text-sm font-medium text-gray-700">Slogan</label>
                        <textarea id="slogan" rows="2" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="e.g., We innovate for you."></textarea>
                    </div>
                     <div class="border-t pt-4">
                        <label for="statement" class="block text-sm font-medium text-gray-700">Statement / Disclaimer</label>
                        <textarea id="statement" rows="2" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus-brand-ring focus:border-gray-300" placeholder="e.g., This email is confidential..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Signature Preview -->
            <div class="lg:w-2/3">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-2xl font-semibold mb-4 border-b pb-3">Live Preview</h2>
                    <div id="signature-preview-container" class="p-4 border border-dashed border-gray-300 rounded-lg bg-gray-50 min-h-[200px] flex items-center justify-center">
                        <!-- The signature will be rendered here -->
                        <table id="signature-preview" cellpadding="0" cellspacing="0" style="border-collapse: collapse; font-family: 'Inter', sans-serif; color: #333;">
                            <tbody>
                                <tr>
                                    <!-- Profile Picture -->
                                    <td style="padding-right: 15px; vertical-align: top;">
                                        <img id="preview-image" src="https://placehold.co/100x100/EFEFEF/3A3A3A?text=Photo" alt="Profile" style="border-radius: 50%; width: 100px; height: 100px; object-fit: cover;">
                                    </td>
                                    <!-- Details -->
                                    <td id="details-cell" style="border-left: 2px solid #cb2039; padding-left: 15px; vertical-align: top;">
                                        <p style="margin: 0; font-size: 18px; font-weight: bold; color: #000000;" id="preview-fullName">John Doe</p>
                                        <p style="margin: 2px 0; font-size: 14px; color: #555555;">
                                            <span id="preview-jobTitle">Software Engineer</span>
                                            <span id="separator"> | </span>
                                            <span id="preview-company" style="font-weight: bold;">Tech Solutions Inc.</span>
                                        </p>
                                        <div style="margin-top: 10px; font-size: 13px; color: #555555;">
                                            <p style="margin: 2px 0;"><strong>P:</strong> <span id="preview-phone">+1 (123) 456-7890</span></p>
                                            <p style="margin: 2px 0;"><strong>E:</strong> <a id="preview-email-link" href="mailto:john.doe@example.com" style="color: #cb2039; text-decoration: none;"><span id="preview-email">john.doe@example.com</span></a></p>
                                            <p style="margin: 2px 0;"><strong>W:</strong> <a id="preview-website-link" href="https://example.com" target="_blank" style="color: #cb2039; text-decoration: none;"><span id="preview-website">https://example.com</span></a></p>
                                        </div>
                                        <div id="preview-socials" style="margin-top: 10px;"></div>
                                    </td>
                                </tr>
                                <!-- Slogan Row -->
                                <tr id="slogan-row" style="display: none;">
                                    <td colspan="2" style="padding-top: 15px; font-size: 13px; color: #555555; font-weight: bold; text-align: center;">
                                        <p id="preview-slogan" style="margin: 0;"></p>
                                    </td>
                                </tr>
                                <!-- Statement Row -->
                                <tr id="statement-row" style="display: none;">
                                    <td colspan="2" style="padding-top: 10px; font-size: 11px; color: #888888; font-style: italic; text-align: center;">
                                        <p id="preview-statement" style="margin: 0;"></p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="flex gap-4 mt-6">
                        <button id="saveSignatureBtn" class="w-full bg-green-600 text-white py-3 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all shadow-lg">Save Signature</button>
                        <button id="copyButton" class="w-full brand-bg text-white py-3 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus-brand-ring transition-all shadow-lg">Copy Signature</button>
                    </div>
                    <div id="copy-success" class="text-center text-green-600 font-medium mt-2 opacity-0 transition-opacity">
                        Signature copied to clipboard!
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="text-center p-4 text-gray-500 text-sm">
        Made With Love by <a href="https://www.lvbranding.com" target="_blank" class="brand-text hover:underline">LV Branding</a>
    </footer>

    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyBntSc4gkUFkTR13EMLhsvVmTntVJTycbE",
            authDomain: "lv-branding-esg.firebaseapp.com",
            projectId: "lv-branding-esg",
            storageBucket: "lv-branding-esg.appspot.com",
            messagingSenderId: "605170507281",
            appId: "1:605170507281:web:86691e391a97744a229bb0"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const storage = getStorage(app);
        const db = getFirestore(app);
        let currentUser = null;
        let savedSignaturesCache = [];

        // Get all the input elements
        const allInputs = {
            fullName: document.getElementById('fullName'),
            jobTitle: document.getElementById('jobTitle'),
            company: document.getElementById('company'),
            phone: document.getElementById('phone'),
            email: document.getElementById('email'),
            website: document.getElementById('website'),
            imageUrl: document.getElementById('imageUrl'),
            slogan: document.getElementById('slogan'),
            statement: document.getElementById('statement'),
            fontStyle: document.getElementById('fontStyle'),
            accentColor: document.getElementById('accentColor'),
            imageShape: document.getElementById('imageShape'),
            linkedin: document.getElementById('linkedin'),
            twitter: document.getElementById('twitter'),
            instagram: document.getElementById('instagram'),
            facebook: document.getElementById('facebook'),
        };
        const copyButton = document.getElementById('copyButton');
        const copySuccessMessage = document.getElementById('copy-success');
        const imageUploadInput = document.getElementById('imageUpload');
        const uploadStatus = document.getElementById('uploadStatus');
        const saveSignatureBtn = document.getElementById('saveSignatureBtn');
        const loadSignatureBtn = document.getElementById('loadSignatureBtn');
        const deleteSignatureBtn = document.getElementById('deleteSignatureBtn');
        const savedSignaturesSelect = document.getElementById('savedSignatures');

        // Get all the preview elements
        const signaturePreviewTable = document.getElementById('signature-preview');
        const previewFullName = document.getElementById('preview-fullName');
        const previewJobTitle = document.getElementById('preview-jobTitle');
        const previewCompany = document.getElementById('preview-company');
        const previewPhone = document.getElementById('preview-phone');
        const previewEmail = document.getElementById('preview-email');
        const previewEmailLink = document.getElementById('preview-email-link');
        const previewWebsite = document.getElementById('preview-website');
        const previewWebsiteLink = document.getElementById('preview-website-link');
        const previewImage = document.getElementById('preview-image');
        const previewSlogan = document.getElementById('preview-slogan');
        const previewStatement = document.getElementById('preview-statement');
        const separator = document.getElementById('separator');
        const sloganRow = document.getElementById('slogan-row');
        const statementRow = document.getElementById('statement-row');
        const detailsCell = document.getElementById('details-cell');
        const previewSocials = document.getElementById('preview-socials');
        
        // --- Firebase Auth ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                console.log("User signed in anonymously:", currentUser.uid);
                fetchSignatures();
            } else {
                signInAnonymously(auth).catch((error) => {
                    console.error("Anonymous sign-in failed:", error);
                });
            }
        });

        // --- Firestore Functions ---
        async function fetchSignatures() {
            if (!currentUser) return;
            const q = query(collection(db, "signatures"), where("userId", "==", currentUser.uid));
            const querySnapshot = await getDocs(q);
            savedSignaturesCache = [];
            savedSignaturesSelect.innerHTML = '';
            
            if (querySnapshot.empty) {
                savedSignaturesSelect.innerHTML = '<option>No signatures saved</option>';
                return;
            }

            querySnapshot.forEach((doc) => {
                savedSignaturesCache.push({ id: doc.id, ...doc.data() });
                const option = document.createElement('option');
                option.value = doc.id;
                option.textContent = doc.data().name;
                savedSignaturesSelect.appendChild(option);
            });
        }

        saveSignatureBtn.addEventListener('click', async () => {
            if (!currentUser) {
                alert("Please wait for user session to initialize.");
                return;
            }
            const name = prompt("Enter a name for this signature:");
            if (!name) return;

            const signatureData = { userId: currentUser.uid, name };
            for (const key in allInputs) {
                signatureData[key] = allInputs[key].value;
            }

            try {
                await addDoc(collection(db, "signatures"), signatureData);
                alert(`Signature "${name}" saved successfully!`);
                fetchSignatures();
            } catch (e) {
                console.error("Error adding document: ", e);
                alert("Failed to save signature.");
            }
        });
        
        loadSignatureBtn.addEventListener('click', () => {
            const selectedId = savedSignaturesSelect.value;
            const signatureToLoad = savedSignaturesCache.find(sig => sig.id === selectedId);
            if (!signatureToLoad) {
                alert("Please select a signature to load.");
                return;
            }
            for (const key in allInputs) {
                if (signatureToLoad[key] !== undefined) {
                    allInputs[key].value = signatureToLoad[key];
                }
            }
            updatePreview();
        });

        deleteSignatureBtn.addEventListener('click', async () => {
             const selectedId = savedSignaturesSelect.value;
             if (!selectedId || savedSignaturesSelect.options[0].textContent === 'No signatures saved') {
                alert("Please select a signature to delete.");
                return;
             }
             if (confirm("Are you sure you want to delete this signature?")) {
                 try {
                    await deleteDoc(doc(db, "signatures", selectedId));
                    alert("Signature deleted successfully.");
                    fetchSignatures();
                 } catch (e) {
                     console.error("Error deleting document: ", e);
                     alert("Failed to delete signature.");
                 }
             }
        });

        // --- Storage Functions ---
        imageUploadInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            if (!currentUser) {
                alert("Please wait, initializing user session.");
                return;
            }

            const storageRef = ref(storage, `logos/${currentUser.uid}/${file.name}`);
            uploadStatus.textContent = 'Uploading...';

            uploadBytes(storageRef, file).then((snapshot) => {
                getDownloadURL(snapshot.ref).then((downloadURL) => {
                    allInputs.imageUrl.value = downloadURL;
                    uploadStatus.textContent = 'Upload complete!';
                    updatePreview();
                     setTimeout(() => { uploadStatus.textContent = ''; }, 3000);
                });
            }).catch((error) => {
                console.error("Upload failed:", error);
                uploadStatus.textContent = 'Upload failed.';
            });
        });

        // --- Core App Logic ---
        function updatePreview() {
            const data = {};
            for (const key in allInputs) {
                data[key] = allInputs[key].value;
            }

            previewFullName.textContent = data.fullName || 'John Doe';
            previewJobTitle.textContent = data.jobTitle || 'Job Title';
            previewCompany.textContent = data.company || 'Company Name';
            previewPhone.textContent = data.phone || '+1 (123) 456-7890';
            previewEmail.textContent = data.email || 'your.email@example.com';
            previewEmailLink.href = `mailto:${data.email}`;
            previewWebsite.textContent = data.website || 'https://example.com';
            previewWebsiteLink.href = data.website;
            
            previewImage.src = data.imageUrl || 'https://placehold.co/100x100/EFEFEF/3A3A3A?text=Photo';
            previewImage.onerror = function() { this.src = 'https://placehold.co/100x100/EFEFEF/3A3A3A?text=Error'; };

            separator.style.display = (data.jobTitle && data.company) ? 'inline' : 'none';

            if (data.slogan) {
                sloganRow.style.display = 'table-row';
                previewSlogan.textContent = data.slogan;
            } else {
                sloganRow.style.display = 'none';
            }

            if (data.statement) {
                statementRow.style.display = 'table-row';
                previewStatement.textContent = data.statement;
            } else {
                statementRow.style.display = 'none';
            }
            
            signaturePreviewTable.style.fontFamily = data.fontStyle;
            
            detailsCell.style.borderLeftColor = data.accentColor;
            previewEmailLink.style.color = data.accentColor;
            previewWebsiteLink.style.color = data.accentColor;

            switch (data.imageShape) {
                case 'square':
                    previewImage.style.borderRadius = '8px';
                    previewImage.style.width = '100px';
                    previewImage.style.height = '100px';
                    break;
                case 'wide':
                    previewImage.style.borderRadius = '8px';
                    previewImage.style.width = '128px';
                    previewImage.style.height = '72px';
                    break;
                case 'standard':
                    previewImage.style.borderRadius = '8px';
                    previewImage.style.width = '120px';
                    previewImage.style.height = '90px';
                    break;
                case 'circle':
                default:
                    previewImage.style.borderRadius = '50%';
                    previewImage.style.width = '100px';
                    previewImage.style.height = '100px';
                    break;
            }
            
            previewSocials.innerHTML = '';
            const socialLinks = [
                { url: data.linkedin, icon: 'linkedin', name: 'LinkedIn' },
                { url: data.twitter, icon: 'x', name: 'Twitter' },
                { url: data.instagram, icon: 'instagram', name: 'Instagram' },
                { url: data.facebook, icon: 'facebook', name: 'Facebook' },
            ];

            socialLinks.forEach(social => {
                if (social.url) {
                    const iconHtml = `<a href="${social.url}" target="_blank" style="text-decoration: none; margin-right: 8px;"><img src="https://cdn.simpleicons.org/${social.icon}/888888" alt="${social.name}" width="20" height="20" style="display: inline-block;"></a>`;
                    previewSocials.innerHTML += iconHtml;
                }
            });
        }

        Object.values(allInputs).forEach(input => {
            input.addEventListener('input', updatePreview);
        });

        copyButton.addEventListener('click', () => {
            const signatureHTML = document.getElementById('signature-preview').outerHTML;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.style.position = 'absolute';
            tempTextArea.style.left = '-9999px';
            tempTextArea.value = signatureHTML;
            document.body.appendChild(tempTextArea);
            try {
                if (navigator.clipboard && window.isSecureContext) {
                    const blob = new Blob([signatureHTML], { type: 'text/html' });
                    const clipboardItem = new ClipboardItem({ 'text/html': blob });
                    navigator.clipboard.write([clipboardItem]).then(() => showSuccessMessage());
                } else {
                    tempTextArea.select();
                    document.execCommand('copy');
                    showSuccessMessage();
                }
            } catch (err) {
                console.error('Failed to copy text: ', err);
            } finally {
                document.body.removeChild(tempTextArea);
            }
        });

        function showSuccessMessage() {
            copySuccessMessage.classList.remove('opacity-0');
            setTimeout(() => {
                copySuccessMessage.classList.add('opacity-0');
            }, 2000);
        }

        updatePreview();
    </script>

</body>
</html>
